为了理解sendfile的影响，理解数据从文件传入socket通用的传输路径是很重要的：
![[Pasted image 20210208153009.png]]
1. 操作系统将数据从磁盘读入内核空间的页面缓存中。
2. 操作系统将数据从内核空间读入用户空间的缓存中。
3. 应用程序将数据写回到内核空间中的套接字缓存中去	。
4. 操作系统从套接字缓存中复制数据到通过网络发送的NIC（Network interface card 网卡）缓存区中。
这种方式是低效的，这包含四次数据拷贝和两次系统调用。而使用sendfile，通过允许操作系统将数据直接从页面缓存发送到网络避免这种重复的数据拷贝。所以使用这种优化方式下，仅仅需最中复制数据到NIC缓存区中一次数据复制。